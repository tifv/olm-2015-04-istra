% $timetable:
%   g10r1: {}

\section*{Доказательство неравенства Караматы}

% $authors:
% - Владимир Трушков

\claim{Лемма о трех хордах}
Если $f$~--- выпуклая функция, то~для любых $z < y < x$ имеет место неравенство
\[
    \frac{f(y) - f(z)}{y - z}
\leq
    \frac{f(x) - f(z)}{x - z}
\leq
    \frac{f(x) - f(y)}{x - y}.
\] 

\textit{Доказательство.}
Заметим, что %
\(
    y = \frac{y - z}{x - z} \cdot x + \frac{x - y}{x - z} \cdot z
\),
откуда по~определению выпуклости
\[
    f(y)
\leq
    \frac{y - z}{x - z} \cdot f(x) + \frac{x - y}{x - z} \cdot f(z)
\,.\]
Следовательно,
$(x - z) \cdot f(y) \leq (y - z) \cdot f(x) + (x - y) \cdot f(z)$,
откуда
\[
    (x - y) \cdot (f(x) - f(z))
\leq
    (x - z) \cdot (f(x) - f(y))
\,.\]
Второе неравенство получается аналогично.

\claim{Лемма}
Если $f$~--- выпуклая функция, то~для любых
$x_1 \geq x_2$, $y_1 \geq y_2$, $x_1 \neq y_1$, $x_2 \neq y_2$ имеет место
неравенство
\[
    \frac{f(x_1) - f(y_1)}{x_1 - y_1}
\geq
    \frac{f(x_2) - f(y_2)}{x_2 - y_2}
\;.\]

\textit{Доказательство.}
Пусть для определенности $x_1 \geq y_1$.
Тогда по~лемме о~трех хордах
\[
    \frac{f(x_1) - f(y_1)}{x_1 - y_1}
\geq
    \frac{f(x_2) - f(y_1)}{x_2 - y_1}
\geq
    \frac{f(x_2) - f(y_2)}{x_2 - y_2}
\;.\]

\definition
Пусть $X = (x_1, x_2, \ldots, x_n)$~--- набор вещественных чисел.
Его \emph{невозрастающей перестановкой} назовем набор
$X^* = (x_{i_1}, x_{i_2}, \ldots, x_{i_n})$, где
$x_{i_1} \geq x_{i_2} \geq \ldots \geq x_{i_n}$
и~$(i_1, i_2, \ldots, i_n)$~--- перестановка чисел $(1, 2, \ldots, n)$.

\definition
Невозрастающий набор вещественных чисел $X = (x_1, x_2, \ldots, x_n)$
\emph{мажорирует}
невозрастающий набор вещественных чисел $Y = (y_1, y_2, \ldots, y_n)$,
если выполнены условия
\begin{gather*}
    x_1 \geq y_1
,\\
    x_1 + x_2 \geq y_1 + y_2
,\\ \cdots \\
    x_1 + x_2 + \ldots + x_{n-1} \geq y_1 + y_2 + \ldots + y_{n-1}
,\\
    x_1 + x_2 + \ldots + x_{n-1} + x_n = y_1 + y_2 + \ldots + y_{n-1} + y_n
.\\
\end{gather*}
Если $X$ мажорирует $Y$, то~будем писать $X \succ Y$ или $Y \prec X$.

В~случае, когда $X$ и~$Y$~--- произвольные наборы чисел,  мы~будем говорить,
что $X$ мажорирует $Y$ и~писать $X\succ Y$ или $Y\prec X$, если для
их~невозрастающих перестановок $X^*$ и~$Y^*$ верно $X^*\succ Y^*$.

\claim{Пример\;1}
\[
    \left( 1, 0, \ldots, 0 \right)
\succ
    \left( \frac{1}{2}, \frac{1}{2}, 0, \ldots,0 \right)
\succ
    \left( \frac{1}{3}, \frac{1}{3}, \frac{1}{3}, 0, \ldots, 0 \right)
\succ\ldots\succ
    \left( \frac{1}{n}, \ldots, \frac{1}{n} \right)
\;,\]
и~вообще, если $x_1$, $x_2$,~$\dots$, $x_n$~--- неотрицательные числа, сумма
которых равна $1$, то%
\[
    \left( \frac{1}{n}, \ldots, \frac{1}{n} \right)
\prec
    \left( x_1, x_2, \ldots, x_n \right)
\prec
    \left( 1, 0, \ldots, 0 \right)
\,.\]

\claim{Пример\;2}
Наборы $(5, 5, 0)$ и~$(6, 2, 2)$ несравнимы, т.~е. ни~один из~них
не~мажорирует другой.

\claim{Пример\;3}
Если $\ov{x} = \frac{x_1 + x_2 + \ldots + x_n}{n}$,
то~$(x_1, x_2, \ldots, x_n) \succ (\ov{x}, \ov{x}, \ldots, \ov{x})$.

\claim{Пример\;4}
Набор $(x_1, x_2)$ мажорирует набор $(y_1, y_2)$, если и~только если
$y_1 = (1 - \lambda) x_1 + \lambda x_2$
и~$y_2 = \lambda x_1 + (1 - \lambda) x_2$
для некоторого $\lambda \in [0; 1]$.

\hrulefill

\claim{Неравенство Караматы}
Пусть $f \colon (a; b) \to \mathbb{R}$~--- выпуклая функция,
$x_1, x_2, \ldots, x_n$, $y_1, y_2, \ldots, y_n \in (a; b)$ и%
\[
    X = (x_1, x_2, \ldots, x_n) \succ Y = (y_1, y_2, \ldots, y_n)
\,.\]
Тогда
\[
    f(x_1) + f(x_2) + \ldots + f(x_n)
\geq
    f(y_1) + f(y_2) + \ldots + f(y_n)
\,.\]

\textit{Доказательство.}
Центральным моментом доказательства является \emph{преобразование Абеля}
\[
    \sum\limits_{k=1}^n
        a_k \cdot b_k
=
    \sum\limits_{k=1}^{n-1}
        A_k \cdot (b_k - b_{k+1}) + A_n \cdot b_n
\,,\]
где $A_k = a_1 + a_2 + \ldots + a_k$.

Можно считать, что $x_k \neq y_k$ при всех $k$, в~противном случае уберем
из~обеих частей слагаемые $f(x_k) = f(y_k)$.
Очевидно, что мажоризация укороченных наборов сохранится.
Положим
\begin{gather*}
    D_k = \frac{f(x_k) - f(y_k)}{x_k - y_k}
,\\
    X_k = x_1 + x_2 + \ldots + x_k
,\quad
    Y_k = y_1 + y_2 + \ldots + y_k
\,.\end{gather*}
Тогда условие $X \succ Y$ означает, что $X_k \geq Y_k$ при $k \leq (n - 1)$
и~$X_n = Y_n$, а~следствие из~леммы о~трех хордах утверждает, что
$D_k \geq D_{k+1}$.
Стало быть,
\[
    \sum\limits_{k=1}^{n-1}
        (X_k - Y_k) \cdot (D_k - D_{k+1})
    +
    (X_n - Y_n) \cdot D_n
\geq
    0
\,.\]
Применим к~левой части преобразование Абеля
($a_k = x_k - y_k$, $A_k = X_k - Y_k$, $b_k = D_k$), получим:
\[
    \sum\limits_{k=1}^n
        (x_k - y_k) \cdot D_k
\geq
    0
\,.\]
Следовательно,
\[
    \sum\limits_{k=1}^n
        \bigl( f(x_k) - f(y_k) \bigr)
=
    \sum\limits_{k=1}^n
        (x_k - y_k) \cdot \frac{f(x_k) - f(y_k)}{x_k - y_k}
=
    \sum\limits_{k=1}^n
        (x_k - y_k) \cdot D_k
\geq
    0
\,.\]
Что и~требовалось доказать.

\claim{Замечание\;1}
Условие $X \succ Y$ является не~только достаточным, но~и~необходимым.

\claim{Замечание\;2}
Условие выпуклости функции $f(x)$ является не~только достаточным,
но~и~необходимым.

\claim{Замечание\;3}
Если функция $f(x)$ выпуклая и~\emph{монотонно возрастающая,} то~условие
$X \succ Y$ может быть заменено более слабым, а~именно равенство $X_n = Y_n$
можно заменить на~$X_n \geq Y_n$.
Докажите этот факт.

\claim{Замечание\;4}
Если $f(x)$~--- вогнутая функция, то%
\[
    f(x_1) + f(x_2) + \ldots + f(x_n)
\leq
    f(y_1) + f(y_2) + \ldots + f(y_n)
\,.\]

\claim{Замечание\;5}
При $y_1 = y_2 = \ldots = y_n = \frac{x_1 + x_2 + \ldots + x_n}{n}$
неравенство Караматы превращается в~неравенство Йенсена для коэффициентов,
равных $1 / n$.

